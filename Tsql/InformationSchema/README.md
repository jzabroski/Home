# Queries For Manipulating INFORMATION_SCHEMA schema

```sql
DECLARE @TableName sysname = 'YourTable';

SELECT
	C.TABLE_SCHEMA AS [PrimaryKeyTableSchema],
	C.TABLE_NAME AS [PrimaryKeyTableName],
	STRING_AGG(QUOTENAME(KCU.COLUMN_NAME), ', ') AS [PrimaryKeyColumnNames],
	C2.TABLE_SCHEMA [ForeignKeyTableSchema],
	C2.TABLE_NAME [ForeignKeyTableName],
	STRING_AGG(QUOTENAME(KCU2.COLUMN_NAME), ', ') [ForeignKeyColumnNames],
	RC.UPDATE_RULE AS [ConstraintUpdateRule],
	RC.DELETE_RULE AS [ConstraintDeleteRule],
	C.CONSTRAINT_NAME [ForeignKeyName],
	C2.CONSTRAINT_NAME [PrimaryKeyName]
FROM
	INFORMATION_SCHEMA.TABLE_CONSTRAINTS C
	INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE KCU
		ON C.CONSTRAINT_SCHEMA = KCU.CONSTRAINT_SCHEMA
		AND C.CONSTRAINT_NAME = KCU.CONSTRAINT_NAME
	INNER JOIN INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS RC
		ON C.CONSTRAINT_SCHEMA = RC.CONSTRAINT_SCHEMA
		AND C.CONSTRAINT_NAME = RC.CONSTRAINT_NAME
	INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS C2
		ON RC.UNIQUE_CONSTRAINT_SCHEMA = C2.CONSTRAINT_SCHEMA
		AND RC.UNIQUE_CONSTRAINT_NAME = C2.CONSTRAINT_NAME
	INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE KCU2
		ON C2.CONSTRAINT_SCHEMA = KCU2.CONSTRAINT_SCHEMA
		AND C2.CONSTRAINT_NAME = KCU2.CONSTRAINT_NAME
		AND KCU.ORDINAL_POSITION = KCU2.ORDINAL_POSITION
WHERE C.CONSTRAINT_TYPE = 'FOREIGN KEY'
	AND c2.TABLE_NAME = @TableName
GROUP BY
	C.TABLE_SCHEMA,
	C.TABLE_NAME,
	C2.TABLE_SCHEMA,
	C2.TABLE_NAME,
	RC.UPDATE_RULE,
	RC.DELETE_RULE,
	C.CONSTRAINT_NAME,
	C2.CONSTRAINT_NAME
```
